{% extends "layout.html" %}
{% block body %}
<div class="row">
    <div class="col-md-3">
{% include "sidebar.html" %}
    </div>
    <div class="col-md-9">
{% block application %}{% endblock %}
    </div>
{% endblock %}

{% block scripts %}
<script src="/js/main.js"></script>
{% block application_scripts %}{% endblock %}
<script>
var formData;
$(document).ready(function() {
    formData = $('#application').serialize();
    $('#application').submit(submitApplication);
});
function submitApplication() {
    $('#submit').button('loading');
    newData = $('#application').serialize();
    if (formData != newData) {
        $.ajax({
            type: 'POST',
            url: '{{ application_url }}',
            data: newData
        })
        .done(function(data) {
            $('#submit').button('reset');
            formData = newData;
        });
    }
    else {
        setTimeout(function() { $('#submit').button('reset'); }, 500);
    }
    return false;
}
setInterval(submitApplication, 1*60*1000);
</script>
{% endblock %}

{% macro input(name, label='', value='', type='text', disabled='', size) -%}
<div class="form-group">
    {% if label != '' %}<label for="{{ name }}">{{ label }}</label>{% endif %}
    <input type="{{ type }}" class="form-control {% if size %}{{ size }}{% endif %}" id="{{ name }}" name="{{ name }}" value="{% if value|e != 'None' %}{{ value|e }}{% endif %}" {{ disabled }}>
</div>
{%- endmacro %}

{% macro textarea(name, label='', value='', disabled='', rows='4') -%}
<div class="form-group">
    {% if label != '' %}<label for="{{ name }}">{{ label }}</label>{% endif %}
    <textarea class="form-control" id="{{ name }}" name="{{ name }}" rows="{{ rows }}" {{ disabled }}>{% if value|e != 'None' %}{{ value|e }}{% endif %}</textarea>
</div>
{%- endmacro %}

{% macro select(name, label='', selected, choices, disabled='') -%}
<div class="form-group">
    <label for="{{ name }}" class="control-label">{{ label }}</label>
    <select class="form-control" id="{{ name }}" name="{{ name }}" {{ disabled }}>
    {% for choice in choices %}
        <option value="{{ choice }}"{% if choice == selected %} selected{% endif %}>{{ choice }}</option>
    {% endfor %}
    </select>
</div>
{%- endmacro %}

{% macro input_horizontal(name, label='', value='', type='text', disabled='', size=4) -%}
<div class="form-group">
    <label for="{{ name }}" class="col-md-{{ size }} control-label">{{ label }}</label>
    <div class="col-md-{{ 12 - size }}">
        <input type="{{ type }}" class="form-control" id="{{ name }}" name="{{ name }}" value="{% if value|e != 'None' %}{{ value|e }}{% endif %}" {{ disabled }}>
    </div>
</div>
{%- endmacro %}

{% macro input_horizontal_small(name, label='', value='', type='text', disabled='', size=4) -%}
<div class="form-group-sm">
    {% if label != '' %}<label for="{{ name }}" class="col-md-{{ size }} control-label">{{ label }}</label>{% endif %}
    <div class="col-md-{{ 12 - size }}">
        <input type="{{ type }}" class="form-control" id="{{ name }}" name="{{ name }}" value="{% if value|e != 'None' %}{{ value|e }}{% endif %}" {{ disabled }}>
    </div>
</div>
{%- endmacro %}

{% macro textarea_horizontal(name, label='', value='', disabled='', rows='4', size=4) -%}
<div class="form-group">
    {% if label != '' %}<label for="{{ name }}" class="col-md-{{ size }} control-label">{{ label }}</label>{% endif %}
    <div class="col-md-{{ 12 - size }}">
        <textarea class="form-control" id="{{ name }}" name="{{ name }}" rows="{{ rows }}" {{ disabled }}>{% if value|e != 'None' %}{{ value|e }}{% endif %}</textarea>
    </div>
</div>
{%- endmacro %}

{% macro select_horizontal(name, label='', selected, choices, disabled='', size=4) -%}
<div class="form-group">
    <label for="{{ name }}" class="col-md-{{ size }} control-label">{{ label }}</label>
    <div class="col-md-{{ 12 - size }}">
        <select class="form-control" id="{{ name }}" name="{{ name }}" {{ disabled }}>
        {% for choice in choices %}
            <option value="{{ choice }}"{% if choice == selected %} selected{% endif %}>{{ choice }}</option>
        {% endfor %}
        </select>
    </div>
</div>
{%- endmacro %}

{% macro checkbox(name, label='', checked=False, disabled='') -%}
<div class="checkbox {{ disabled }}">
    <label>
        <input type="checkbox" name="{{ name }}"{% if checked %} checked{% endif %} {{ disabled }}>
        {{ label }}
    </label>
</div>
{%- endmacro %}
