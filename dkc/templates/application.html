{% extends "layout.html" %}
{% block body %}
<div class="row">
    <div class="col-md-3">
{% include "sidebar.html" with context %}
    </div>
    <div class="col-md-9">
{% block application %}{% endblock %}
    </div>
{% endblock %}

{% block scripts %}
<script>
var formData;
$(document).ready(function() {
    formData = $('#application').serialize();
    $('#application').submit(submitApplication);
});
function submitApplication() {
    $('#submit').button('loading');
    newData = $('#application').serialize();
    if (formData != newData) {
        $.ajax({
            type: 'POST',
            url: '{{ application_url }}',
            data: newData
        })
        .done(function(data) {
            $('#submit').button('reset');
            formData = newData;
        });
    }
    else {
        setTimeout(function() { $('#submit').button('reset'); }, 500);
    }
    return false;
}
setInterval(submitApplication, 1*60*1000);
</script>
{% endblock %}

{% macro input(name, label='', value='', type='text', disabled='') -%}
<div class="form-group">
    {% if label != '' %}<label for="{{ name }}">{{ label }}</label>{% endif %}
    <input type="{{ type }}" class="form-control" id="{{ name }}" name="{{ name }}" value="{% if value|e != 'None' %}{{ value|e }}{% endif %}" {{ disabled }}>
</div>
{%- endmacro %}

{% macro textarea(name, label='', value='', disabled='', rows='5') -%}
<div class="form-group">
    {% if label != '' %}<label for="{{ name }}">{{ label }}</label>{% endif %}
    <textarea class="form-control" id="{{ name }}" name="{{ name }}" rows="{{ rows }}" {{ disabled }}>{% if value|e != 'None' %}{{ value|e }}{% endif %}</textarea>
</div>
{%- endmacro %}

{% macro input_horizontal(name, label='', value='', type='text', disabled='') -%}
<div class="form-group">
    <label for="{{ name }}" class="col-md-4 control-label">{{ label }}</label>
    <div class="col-md-8">
        <input type="{{ type }}" class="form-control" id="{{ name }}" name="{{ name }}" value="{% if value|e != 'None' %}{{ value|e }}{% endif %}" {{ disabled }}>
    </div>
</div>
{%- endmacro %}
